Changes from Evgenii Peshkov 3